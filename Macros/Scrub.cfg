## -+- Cleaning Nozzle Marco -+- ##

## --- if you got time to Lean, You got time to Clean..
[gcode_macro CLEAN_NOZZLE]
gcode:
    ## -- Define Parameters 
    ## -- Swipes
    {% set Swipe = params.Swipe|default(6)|int %}
    ## -- Speed
    {% set Speed = params.Speed|default(200)|int %}
    ## -- Droping down the nozzle
    {% set Nozzle = params.Nozzle|default(4)|float %}
    
    ## -- Mr. Clean Magic 
    CG28
    SAVE_GCODE_STATE NAME=CLEAN_NOZZLE
    G90                                                    ; absolute positioning
    G0 X256 Z10 Y{printer.toolhead.axis_maximum.y} F8000   ; move to right of nozzle brush
    G0 Z{Nozzle} F8000                                         ; move down to nozzle brush
    {% for iteration in range(Swipe|int) %}
        G0 X210 F{Speed*60}                                    ; wipe back
        G0 X256 F{Speed*60}                                    ; wipe forth
    {% endfor %}
    G0 Z16 F{Speed*60}
    G0 X171 F{Speed*60}                                        ; wipe back
    RESTORE_GCODE_STATE NAME=CLEAN_NOZZLE
## -//-